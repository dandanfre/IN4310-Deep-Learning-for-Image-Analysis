{'_root_dir': '/itf-fi-ml/home/danif/mand2/mandatory2_data', 'train_caption_file': '/itf-fi-ml/home/danif/mand2/mandatory2_data/annotations/captions_train2017.json', 'val_caption_file': '/itf-fi-ml/home/danif/mand2/mandatory2_data/annotations/captions_val2017.json', 'val_images_dir': '/itf-fi-ml/home/danif/mand2/mandatory2_data/val2017', 'resnet50_features_train_file': '/itf-fi-ml/home/danif/mand2/mandatory2_data/coco_train_resnet18_layer4_features.pkl', 'resnet50_features_val_file': '/itf-fi-ml/home/danif/mand2/mandatory2_data/coco_val_resnet18_layer4_features.pkl', 'max_caption_length': 30, 'embedding_size': 512, 'hidden_size': 512, 'use_attention': False, 'feature_size': 512, 'num_layers': 2, 'cell_type': 'LSTM', 'vocabulary_file': '/itf-fi-ml/home/danif/mand2/mandatory2_data/vocabulary.csv', 'vocabulary_size': 5000, 'learning_rate': 0.0001, 'weight_decay': 1e-05, 'num_epochs': 10, 'batch_size': 16}
Compose(
    Resize(size=256, interpolation=bilinear, max_size=None, antialias=None)
    RandomCrop(size=(224, 224), padding=None)
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-30.0, 30.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.3, 1.3), contrast=(0.3, 1.3), saturation=(0.3, 1.3), hue=(-0.2, 0.2))
    GaussianBlur(kernel_size=(3, 3), sigma=(0.1, 2.0))
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
Epoch 0 took 0:35:17.290675
Epoch [1/10], Loss:  3.6475
Eval after epoch 0 took 0:00:32.570439
Bleu@4: 0.10117435850685988
CIDEr: 0.3171550677738964
ROUGE-L: 0.35733497426958927
New best CIDEr score is 0.3171550677738964
Saving model at ckpts/danif_2025-04-08 23:26:47.pth
Some random captions from the model for the val set:
['a street sign with a signs sign it it a a.']
['a group of people standing on a of field.']
['a fire fire is sitting on the sidewalk of a street.']
['a sheep of in sheep grass a a.']
['a horse horse a a in Epoch 1 took 0:34:27.3Epoch 1 took 0:34:58.717218
Epoch [2/10], Loss:  3.1284
Eval after epoch 1 took 0:00:32.536687
Bleu@4: 0.10659457209815618
CIDEr: 0.33985744130534556
ROUGE-L: 0.3584413839913478
New best CIDEr score is 0.33985744130534556
Saving model at ckpts/danif_2025-04-08 23:26:47.pth
Some random captions from the model for the val set:
['a person flying a the in on air snow.']
['a giraffe giraffe in head of a grass of.']
['a bear bear is in in water water the.']
['a baseball player swinging a bat at a ball.']
['a airplaEpoch 2 took 0:34:21.854490
EpoEpoch 2 took 0:34:46.626302
Epoch [3/10], Loss:  2.9896
Eval after epoch 2 took 0:00:32.437928
Bleu@4: 0.10739543803744775
CIDEr: 0.35262431088185947
ROUGE-L: 0.36110064733733377
New best CIDEr score is 0.35262431088185947
Saving model at ckpts/danif_2025-04-08 23:26:47.pth
Some random captions from the model for the val set:
['a building building a a and and tower clock a.']
['a man riding a bike with a dog on a back.']
['a laptop computer is a on and desk laptop a.']
['a woman is a a and of dog in a of.']
['a small dog dog a a oEpoch 3 took 0:3Epoch 3 took 0:34:19.903332
Epoch [4/10], Loss:  2.8969
Eval after epoch 3 took 0:00:32.366370
Bleu@4: 0.10168206801606995
CIDEr: 0.34063638551920183
ROUGE-L: 0.3581614814783464
Some random captions from the model for the val set:
['a man is a a with and dog dog a.']
['a zebra standing in a field field a trees.']
['a street sign with a arrow of the street of on.']
['a man of a woman riding a motorcycle with a man on a bacEpoch 4 took 0:34:17.136326
Epoch [5/10], Loss: Epoch 4 took 0:35:05.871858
Epoch [5/10], Loss:  2.8234
Eval after epoch 4 took 0:00:32.855015
Bleu@4: 0.1034854227628667
CIDEr: 0.34645435968675037
ROUGE-L: 0.3574914407380938
Some random captions from the model for the val set:
['a small is is a on of of outside.']
['a surfboard of on on table beach a to.']
['a man with a and and shirt tie a a.']
['a young of kicking soccer soccer on a field.']Epoch 5 took 0:35:14.805341
Epoch [6/10], LoEpoch 5 took 0:35:10.598824
Epoch [6/10], Loss:  2.7614
Eval after epoch 5 took 0:00:32.632679
Bleu@4: 0.10638967154710915
CIDEr: 0.3537173210084253
ROUGE-L: 0.361543443378887
New best CIDEr score is 0.3537173210084253
Saving model at ckpts/danif_2025-04-08 23:26:47.pth
Some random captions from the model for the val set:
['a zebras of in grazing and with grass in the background.']
['a car of at street intersection on a rainy day.']
['a black cat sitting on a of in chair of to table.']
['a large of sitting sitting topEpoch 6 took 0:33:25.171033
Epoch [7/10], Loss:  2.7094
Eval Epoch 6 took 0:36:03.407668
Epoch [7/10], Loss:  2.7094
Eval after epoch 6 took 0:00:32.493293
Bleu@4: 0.10766230253280189
CIDEr: 0.3588766139496257
ROUGE-L: 0.36024363284281724
New best CIDEr score is 0.3588766139496257
Saving model at ckpts/danif_2025-04-08 23:26:47.pth
Some random captions from the model for the val set:
['a pizza pizza on a plate plate a a and and.']
['a group of cows walking down the street.']
['a man of a birthday girl with a birthday cake.']
['a man player a to atEpoch 7 took 0:34:52.410803
Epoch [8/10], Loss:  2.6683
Eval after eEpoch 7 took 0:34:34.287325
Epoch [8/10], Loss:  2.6683
Eval after epoch 7 took 0:00:39.519505
Bleu@4: 0.10503001142249507
CIDEr: 0.3533678092731315
ROUGE-L: 0.36094048684544866
Some random captions from the model for the val set:
['a group of people sitting around a table with pizza pizza it.']
['a group of motorcycles are display display display.']
['a car car in a parking lot with a caEpoch 8 took 0:34:31.677035
Epoch [9/10], Loss:  2.6392
Eval after epoch 8 took 0:00:32.761542
Bleu@4: 0.10649430084234526
CIDEpoch 8 took 0:32:43.573310
Epoch [9/10], Loss:  2.6392
Eval after epoch 8 took 0:00:38.041745
Bleu@4: 0.10649430084234526
CIDEr: 0.36089558491512846
ROUGE-L: 0.36009751376614774
New best CIDEr score is 0.36089558491512846
Saving model at ckpts/danif_2025-04-08 23:26:47.pth
Some random captions from the model for the val set:
['a train train down down tracks track a to of some train.']
['a man of a woman in a shirt uniform a a.'Epoch 9 took 0:34:37.143827
Epoch [10/10], Loss:  2.6221
Eval after epoch 9 took 0:00:32.887264
Bleu@4: 0.1051688281374024
CIDEr: 0.356899Epoch 9 took 0:34:20.645992
Epoch [10/10], Loss:  2.6221
Eval after epoch 9 took 0:00:37.066868
Bleu@4: 0.1051688281374024
CIDEr: 0.35689924930557515
ROUGE-L: 0.36013703335682035
Some random captions from the model for the val set:
['a man riding a skateboard on a of.']
['a group of people sitting around a table.']
['a man player a a at ball tennis a.']
['a yellow truck truck a a green and and road road.']
['a man sitting on a bench in a park.']
